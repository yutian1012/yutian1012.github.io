---
title: 高可用实现原理
tags: [architecture]
---

高可用集群主要实现自动侦测(Auto-Detect)故障、自动切换/故障转移(FailOver)和自动恢复(FailBack)。

简单来说就是，用高可用集群软件实现故障检查和故障转移（故障/备份主机切换）的自动化，当然像负载均衡、DNS分发也可提供高可性。当然它们所考虑的高可用维度是不同的。负载均衡主要应对高并发下的服务可用性，防止服务被拖垮。而这里所谓的高可用是为了解决故障服务问题，如网络，软件，硬件等故障问题而引入的。

1）自动侦测(Auto-Detect)/故障检查

自动侦测阶段由主机上的软件通过冗余侦测线，经由复杂的监听程序，逻辑判断，来相互侦测对方运行的情况。

*常用的方法是：集群各节点间通过心跳信息判断节点是否出现故障。*

参考：Pasox算法和Zookeeper

2）自动切换/故障转移（FailOver）

通俗地说，即当A无法为客户服务时，系统能够自动地切换，使B能够及时地顶上继续为客户提供服务，且客户感觉不到这个为他提供服务的对象已经更换。

3）自动恢复/故障回转(FailBack)

自动恢复阶段在备用主机代替故障主机工作后，故障主机可离线进行修复工作。在故障主机修复后，透过冗余通讯线与备用主机（现正式主机）连线，自动切换回修复完成的主机上。

问题：当排除故障后，是否要故障回转？

根据资源粘性和资源约束的设置，一般备用设备单纯只用于备份，性能低于主设备，所以当主设备恢复时应转回，但故障回转需要资源转移，会影响到正在使用的客户，过程代价较高，所以是否需要回转根据实际判断。
