---
title: spring循环依赖
tags: [spring]
---

参考：http://jinnianshilongnian.iteye.com/blog/1415278

spring能够支持set方式的循环依赖，但不能支持构造函数式的循环依赖。

1）循环依赖

循环依赖就是循环引用，就是两个或多个Bean相互之间都相互持有对方，比如CircleA引用CircleB，CircleB引用CircleC，CircleC引用CircleA，则它们最终反映为一个环。

![](/images/java_structure/spring/bean/di-circle.JPG)

2）实例

CircleA类引用CircleB实例

```
@Component
public class CircleA {
    @Resource
    private CircleB circleB;  
    public CircleA() {  
    } 
    //@Autowired
    public CircleA(CircleB circleB) {  
        this.circleB = circleB;  
    }  
    public void setCircleB(CircleB circleB)   
    {  
            this.circleB = circleB;  
        }  
    public void a() {  
       circleB.b();  
    }
}
```

CircleB类引用CircleC实例

```
@Component
public class CircleB {
    @Resource
    private CircleC circleC;  
    public CircleB() {  
    } 
    //@Autowired
    public CircleB(CircleC circleC) {  
        this.circleC = circleC;  
    }  
    public void setCircleC(CircleC circleC)   
    {  
        this.circleC = circleC;  
    }  
    public void b() {  
        circleC.c();  
    }  
}
```

CircleC类引用CircleA实例

```
@Component
public class CircleC {
    @Resource
    private CircleA circleA;  
    public CircleC() {  
    }
    //@Autowired
    public CircleC(CircleA circleA) {  
        this.circleA = circleA;  
    }  
    public void setCircleA(CircleA circleA)   
    {  
        this.circleA = circleA;  
    }  
    public void c() {  
        circleA.a();  
    }  
}
```

3）使用set方式设置依赖

