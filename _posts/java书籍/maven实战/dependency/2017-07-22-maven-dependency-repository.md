---
title: maven从仓库解析依赖
tags: [maven]
---

当本地仓库没有依赖构件的时候，Maven会自动从远程仓库下载；当依赖版本为快照版本的时候，Maven会自动找到最新的快照。

### 依赖解析过程

第一步：system依赖

当依赖的范围是system的时候，Maven直接从本地文件系统解析构件。

第二步：先从本地仓库查找

根据依赖坐标计算仓库路径后，尝试从本地仓库寻找构件，如果发现相应构件，则解析成功。

第三步：到远程仓库中查找

在本地仓库不存在相应构件的情况下，如果依赖的版本是显示的发布版本构件（确定的版本号），则遍历所有的远程仓库，发现后，下载并解析使用。

第四步：RELEASE或者LATEST依赖（不推荐使用）

如果依赖的版本是RELEASE或者LATEST（未给出确定的版本号），则基于更新策略读取所有远程仓库的元数据groupId/artifactId/maven-metadata.xml，将其与本地仓库的对应元数据合并，计算出RELEASE或者LATEST真实的值，然后基于这个真实的值检查本地仓库，或者从远程仓库下载。

第五步：SNAPSHOT版本依赖

如果依赖的是SNAPSHOT版本，则基于更新策略读取所有远程仓库的元数据groupId/artifactId/version/maven-metadata.xml，将其与本地仓库的对应元数据合并后，得到最新快照版本的值，然后基于该值检查本地仓库，或者从远程仓库下载。

第六步：时间戳快照版本

如果最后解析得到的构件版本是时间戳格式的快照，则复制其时间戳格式的文件至非时间戳格式，并使用该构件。

注：当依赖的版本不明确的时候，如RELEASE，LATEST和SNAPSHOT，maven就需要基于更新远程仓库的更新策略来检查更新。

注2：在依赖声明中使用LATEST和RELEASE是不推荐的。RELEASE对应的是最新发布版本构件，还相对可靠，LATEST就非常不可靠了。Maven3中不再支持这种方式的依赖配置了。