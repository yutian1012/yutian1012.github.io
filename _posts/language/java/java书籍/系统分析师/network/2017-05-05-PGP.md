---
title: 系统分析师（软考）--安全电子邮件协议PGP
tags: [analysis]
---

安全电子邮件协议PGP（Pretty Good Privacy）在电子邮件安全实施中被广泛采用，PGP通过单向散列算法对邮件内容进行签  名，以保证信件内容无法被修改，使用公钥和私钥技术保证邮件内容保密且不可否认。  发信人与收信人的公钥都保存在公开的地方，公钥的权威性则可以由第三方进行签名认  证。在PGP系统中，信任是双方的直接关系。

注：PGP是应用层协议

### PGP协议

PGP 是一个完整的电子邮件安全软件包，包括加密、鉴别（摘要判别）、电子签名（私钥的加密）和压缩等技术。

PGP 并没有使用什么新的概念，它只是将现有的一些算法如 MD5，RSA，以及 IDEA 等综合在一起而已。

注：虽然 PGP 已被广泛使用，但 PGP 并不是因特网的正式标准。  

### PGP加密

A向B发送邮件

A有三个密钥：自己的私钥、B的公钥和自己生成的一次性密钥。

B有两个密钥：自己的私钥和A的公钥。

![](/images/book/tech-analysis/net/PGP-send.png)

注：加密后发送的数据包括加密的密钥+加密的邮件及其摘要

1）生成报文鉴别码

报文鉴别码是由邮件的消息摘要+A的私钥使用对称加密方式实现的。

2）对邮件内容和鉴别码进行加密

邮件内容和报文鉴别码是由一次性密钥进行对称加密的，其中，一次性密钥是A的主机生成的。

3）向B传递加密密码

加密的密钥是由一次性密钥和B的公钥进行加密获取的。

### PGP解码

B端接收邮件报文，并对其进行解密

![](/images/book/tech-analysis/net/PGP-receive.png)

1）获取一次性密钥

首先将邮件报文分解成加密的密钥和加密的邮件及其摘要

获取一次性加密密钥：使用B的私钥+加密的密钥（密文），进行解密获取一次性加密密钥

2）对加密的邮件及其摘要使用一次性密钥进行解密

3）获取鉴别码中的摘要并进行比较

鉴别码使用A的公钥进行解密从而获取摘要信息，并与邮件内容计算的摘要内容进行对比。

参考：http://blog.csdn.net/youthon/article/details/7474279

参考：http://baike.baidu.com/link?url=owOVdUkzgmig7Jj_LAUfHC_BmvRB-nMJz9zYQ2z1l1SUnPiaperCU1T71idEEaDbVXrT4Ex3NL58lRB3Bm-9gq