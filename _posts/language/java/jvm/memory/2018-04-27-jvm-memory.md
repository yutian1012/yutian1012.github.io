---
title: jvm内存结构
tags: [jvm]
---

参考：公众号：纯洁的微笑

### java Heap堆

堆空间是用来存储java对象实例的空间，被所有线程共享。

1）空间分配

堆空间分为：老年代和新生代（分三个区，Eden，s0，s1）。

可通过相关的参数设置堆大小（-Xmx），老年代和新生代的比例（-Xmn，或-XX:NewRatio），甚至设置eden与survivor的空间比例（-XX:SurvivorRatio），当survivor达到多大比例时将对象转移到老年代（-XX:TargetSurvivorRatio）。

### java方法区

所有线程共享，也将该区域称为持久代或永久代。jvm可以允许用户和程序指定方法区的初始大小，最小和最大尺寸。可通过-XX:PermSize和-XX:MaxPermSize设置永久代大小。

注：方法区同样存在垃圾收集，因为通过用户定义的类加载器可以动态扩展java程序，一些类也会成为垃圾。jvm可以回收一个未被引用类所占的空间，以使方法区的空间最小。

存放数据：类的类型信息，类型的常量池（constant pool），域（Field）信息，方法（Method）信息，所有的静态变量。

### 线程栈

线程栈，是线程私有区域。jvm中堆的内存越大，线程栈的内存越大，能创建的线程数就越小。可通过-Xss参数色或者线程栈大小。