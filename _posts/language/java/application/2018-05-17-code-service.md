---
title: service层相互调用问题
tags: [architecture]
---

参考：https://www.zhihu.com/question/27139263

1）问题描述

项目中经常会遇到的一个问题，代码一般在编写时时分层处理的，一般分为controller、service和dao层。而service层有可能相互调用。现在存在两种观点，观点一在service中引用其他相关模块的dao，直接通过dao来访问信息。观点二service如果要访问其他模块的信息，应通过引用其他模块的service。

2）分析

观点一：service引用其他模块dao

针对只需要数据访问，使用dao可能更好。但不能保证调用的方法是否需要具备相关的逻辑。如果需要一些简单的逻辑，而为了保障这部分逻辑，可能要在这个service中添加不相关的业务判断。进而造成同一个逻辑在多个service中有多个不同版本的实现。

注：一句话，容易造成代码结构和逻辑混乱

观点二：service与service直接互相调用（推荐）

这种方式，dao层只是用来进行数据访问的，不引入任何的逻辑判断和执行。在使用相关模块的信息时，使用service间相互调用可以屏蔽掉业务内固有的逻辑，代码只需要调用不同的service方法即可。难点在于service的接口设计和方法的隐藏要合理，可能要使用单一职责原则，同时定义出多个接口，供不同的模块引用不同接口，而实现类只有一个。

注：针对A依赖B，同时B也依赖A，也没有什么问题，spring的依赖都是代理实现的（需进一步验证）。

注2：一句话，清晰，简便，高内聚，单一职责，同时易扩展。

3）结论

使用service相互调用，对系统的扩展和内聚会更好。另外，针对service比较紧密的相关模块，可以是facade门面模式，结合这些模块抽出相互依赖的逻辑，实现新的门面方法供外部调用。

4）controller层调用service

controller层可以同时引入多个service，调用相关方法查询数据，这里并没有太多的约束。