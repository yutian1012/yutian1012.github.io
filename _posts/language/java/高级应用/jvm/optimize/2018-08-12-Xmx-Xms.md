---
title: jvm 堆大小设置优化
tags: [jvm]
---

使用参数-Xmx和-Xms将堆的初始大小值与最大值设置为相同值

1）堆

heap也叫做java 堆、GC堆是java虚拟机所管理的内存中最大的一块内存区域，也是被各个线程共享的内存区域，在JVM启动时创建。

该内存区域存放了对象实例及数组（所有new的对象）。

2）堆大小设置

通过用JVM的命令行选项-Xms，-Xmx。

-Xms为JVM启动时申请的最小内存，默认为操作系统物理内存的1/64但小于1G，-Xmx为JVM可申请的最大内存，默认为物理内存的1/4但小于1G。

```
-Xms 256m -Xmx 256m
```

注：不要忘了在大小后面加上”M”或者”G”来表示单位。举个例子，你可以用-Xmx256m来设置堆内存最大的大小为256MB。

3）分析

默认当空余堆内存小于40%时，JVM会增大Heap到-Xmx指定的大小，可通过-XX:MinHeapFreeRation=来指定这个比列；当空余堆内存大于70%时，JVM会减小heap的大小到-Xms指定的大小，可通过XX:MaxHeapFreeRation=来指定这个比列。

对于运行系统，为避免在运行时频繁调整Heap的大小，通常-Xms与-Xmx的值设成一样。

