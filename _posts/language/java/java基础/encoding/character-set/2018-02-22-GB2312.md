---
title: GB2312码
tags: [coding]
---

主要涉及到内码（汉字国际码），国标码（国标交换码），区位码等概念。

1）GB2312码--指的是机内码（不是区位码，也不是国际码）

全称是《信息交换用汉字编码字符集基本集》，它是双字节编码，"高位字节"使用了0xA1-0xF7(把01-87区的区号加上0xA0)，"低位字节"使用了0xA1-0xFE(把01-94加上0xA0)。

为什么加0xA0?

把换算成十六进制的区位码加上2020H，就得到国标码。国标码加上8080H，就得到常用的计算机机内码。因此，区位码的高位和地位都需要加0xA0，才能变成GB2312（内码）。

```
 1000 0000
+0010 0000
---------
 1010 0000  -->A0
```

注：GB2312码（双字节编码，占2个字节）

2）区位码

所谓区位码就是这一94×94的大表格中的行号与列号了，均从1开始编号。汉字"啊"，它就是GB2312方案中的天字第一号汉字，它处于16区01位上，所以它的区位码即是1601。

编码方式，采用了所谓的二维区位编号（只查看低7位），其中横的叫区，竖的叫位，总共87个区（有时也称94个区，88-94区未定义），94个位。区和位的编号都从1开始。

a.汉字区:

具体为16-87区，共87-16+1=72个区，理论空间为72×94=6768（从第16区开始进行汉字编码）

b.空白区：

最下面的88-94区是有待进一步标准化的空白区。（有时也称为94个区，方便记忆）

![](/images/other/encode/GB2312-parts.png)

关于前面的01-15区，概览图左上角的局部放大图

![](/images/other/encode/GB2312-part0-16.png)

3）国标码（国标交换码）

将区位码的区和位分别加上32（即0x20）就得到了国标码。

实例：

```
# 区位码的区和位分别将爱32
"啊"的区位码是16-01，分别加32，得到16+32-01+32=48-33，即是国标码。
# 转存16进制
当然，你通常应该写成16进制，48-33即是0x30-0x21，所以3021即是"啊"十六进制的国标码，使用两字节保存，30为高字节，21为低字节。
```

任意一个图形字符都采用两个字节表示，每个字节均采用七位编码表示，只用了7位，这即是说最高位就是0了。

![](/images/other/encode/GB2312-international.png)

4）汉字内码（机内码，也称为汉字国际码，最终存储在计算机中）

汉字机内码，又称"汉字ASCII码"，简称"内码"，指计算机内部存储，处理加工和传输汉字时所用的由0和1符号组成的代码。

输入码被接受后就由汉字操作系统的"输入码转换模块"转换为机内码，与所采用的键盘输入法无关。机内码是汉字最基本的编码，不管是什么汉字系统和汉字输入方法，输入的汉字外码到机器内部都要转换成机内码，才能被存储和进行各种处理。

*兼容ASCII码*

汉字在计算机内部其内码是唯一的。因为汉字处理系统要保证中西文的兼容，当系统中同时存在ASCII码和汉字国标码时，将会产生二义性。

例如：有两个字节的内容为30H和21H，它既可表示汉字"啊"的国标码，又可表示西文"0"和"!"的ASCII码。为此，汉字机内码应对国标码加以适当处理和变换。

解决方案：GB码的机内码为二字节长的代码，它是在相应GB码的每个字节最高位上加"1"
汉字机内码＝汉字国标码＋8080H。

例如，上述"啊"字的国标码是3021H，其汉字机内码则是B0A1H。

注：为了避免ASCII码和国标码同时使用时产生二义性问题，大部分汉字系统都采用将国标码每个字节高位置1作为汉字机内码。这样既解决了汉字机内码与西文机内码之间的二义性，又使汉字机内码与国标码具有极简单的对应关系。

6）汉字机内码、国标码和区位码三者之间的关系

区位码（十进制）的两个字节分别转换为十六进制后加20H得到对应的国标码；机内码是汉字交换码（国标码）两个字节的最高位分别加1，即汉字交换码（国标码）的两个字节分别加80H得到对应的机内码；区位码（十进制）的两个字节分别转换为十六进制后加A0H得到对应的机内码（因此我们常说GB2312是从A1开始编码的，即范围从A1-A7）。

### 问题：

1）双字节为256*256个区位，为什么使用94*94个区位？

a.GB2312的区和2位都采用7位编码

GB2312方案规定，任意一个图形字符都采用两个字节表示，每个字节均采用七位编码表示（127×127个单元格），为了兼容ASCII（最高位为1，屏蔽掉0-127，即永远不会出现0-127）。那么一字节就能表示127个状态。

b.GB2312首位为A1：

区位码无法用于汉字通信，因为它可能与通信使用的控制码（00H~1FH）（即0~31）发生冲突。ISO2022规定每个汉字的区号和位号必须分别加上32（即二进制数00100000），经过这样的处理而得的代码称为国标交换码，简称交换码。

```
 1000 0000
+0010 0000
---------
 1010 0000  -->A0
```

c.数值94：

0xFF代表结束，而且程序员一般概念上都将0xFF定义为"空"，为了避免代码习惯上的问题，末尾自然选择在了0xFE。因此，最重要的东西来了0xFE-0xA0+1=94。所以最终只有94个有效位了，这也是前面为何是一个94×94的表格。

2）区位码和国标码的区和位为什么相差32

区位码无法用于汉字通信，因为它可能与通信使用的控制码（00H~1FH）（即0~31）发生冲突。为了不与这些控制码冲突，加上32就能跳过它们了。

3）理解GB2312与ASCII码的兼容

GB2312中包含了引文字符，不过是作为所谓的全角字符来看待，但全角英文显示效果其实是很差的。这里的兼容之的是遇到01000110，即字节首位不是1的字节，当成ASCII码来处理，而不是当成GB2312的第一个字节来处理。

全角下的英文字母显示：

![](/images/other/encode/GB2312-char.png)

### 实例查看

"啊"的GB2312的机内码

![](images/other/encode/GB2312-transfer.png)

```
@Test
public void testAh() throws UnsupportedEncodingException {
    String ah = "啊";
    System.out.println(DatatypeConverter.printHexBinary(ah.getBytes("GB2312")).equals("B0A1"));
    }
```