---
title: 数据处理--OLTP
tags: [BI]
---

OLTP是传统的关系型数据库的主要应用，主要是基本的、日常的事务处理，例如银行交易。

参考：http://blog.csdn.net/zhangzheng0413/article/details/8271322/

1）定义

OLTP，也叫联机事务处理（Online Transaction Processing），表示事务性非常高的系统，一般都是高可用的在线系统，以小的事务以及小的查询为主，评估其系统的时候，一般看其每秒执行的Transaction以及Execute SQL的数量。在这样的系统中，单个数据库每秒处理的Transaction往往超过几百个，或者是几千个，Select 语句的执行量每秒几千甚至几万个。

注：典型的OLTP系统有电子商务系统、银行、证券等，如美国eBay的业务数据库，就是很典型的OLTP数据库。

2）瓶颈

OLTP系统最容易出现瓶颈的地方就是CPU与磁盘子系统。

a.CPU瓶颈

cpu出现瓶颈常表现在逻辑读总量与计算性数据库函数或者数据库过程上。

逻辑读总量等于单个语句的逻辑读乘以执行次数，如果单个语句执行速度虽然很快，但是执行次数非常多，那么，也可能会导致很大的逻辑读总量。设计的方法与优化的方法就是减少单个语句的逻辑读，或者是减少它们的执行次数。

计算型的函数，如自定义函数、decode等的频繁使用，也会消耗大量的CPU时间，造成系统的负载升高，正确的设计方法或者是优化方法，需要尽量避免计算函数，如保存计算结果到统计表就是一个好的方法。

b.磁盘子系统

磁盘子系统在OLTP环境中，它的承载能力一般取决于它的IOPS处理能力。因为在OLTP环境中，磁盘物理读一般都是db file sequential read，也就是单块读，但是这个读的次数非常频繁。如果频繁到磁盘子系统都不能承载其IOPS的时候，就会出现大的性能问题。

3）设计和优化方式

OLTP比较常用的设计与优化方式为Cache技术与B-tree索引技术。

a.cache缓存

Cache决定了很多语句不需要从磁盘子系统获得数据，所以，Web cache与Oracle data buffer对OLTP系统是很重要的。

b.索引

在索引使用方面，语句越简单越好，这样执行计划也稳定，而且一定要使用绑定变量，减少语句解析，尽量减少表关联，尽量减少分布式事务，基本不使用分区技术、MV技术、并行技术及位图索引。因为并发量很高，批量更新时要分批快速提交，以避免阻塞的发生。

c.变量绑定和热块

OLTP系统是一个数据块变化非常频繁，SQL语句提交非常频繁的系统。对于数据块来说，应尽可能让数据块保存在内存当中，对于SQL来说，尽可能使用变量绑定技术来达到SQL重用，减少物理I/O 和重复的SQL 解析，从而极大的改善数据库的性能。

热块问题：

当一个块被多个用户同时读取时，Oracle 为了维护数据的一致性，需要使用Latch（门闩）来串行化用户的操作。当一个用户获得了latch后，其他用户就只能等待，获取这个数据块的用户越多，等待就越明显。这就是热快的问题。这种热快可能是数据块，也可能是回滚端块。对于数据块来讲，通常是数据库的数据分布不均匀导致，如果是索引的数据块，可以考虑创建反向索引来达到重新分布数据的目的，对于回滚段数据块，可以适当多增加几个回滚段来避免这种争用。