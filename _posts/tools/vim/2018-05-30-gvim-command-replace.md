---
title: gvim底端命令模式-替换命令
tags: [vim]
---

参考：https://blog.csdn.net/shuangde800/article/details/10554513

*一定要注意待匹配查找的字符可以使用正则，即下列命令中的old字符串*

1）首次替换命令（替换该行中首次匹配的字符）

替换命令是针对行进行操作的，下面的命令是把光标所在行中的old第一次出现的字符修改为new。

注意，这里的光标所在行和第一次出现两个限定条件。

```
: s/old/new/
```

语法分析

```
# s表示switch（替换）
# /（斜杆）是命令不同部分之间的分隔符（当斜杆为该行的最后一个字符时，可不写）。
# 将old对应的字符替换成new对应的字符
```

2）整行替换命令（替换该行中所有的匹配字符）

在替换命令的最后添加g，表示整行数据进行匹配替换。下面的命令是把光标所在行中的old所有匹配的字符都修改为new。

```
: s/old/new/g
```

3）指定范围替换（可以指定多行进行替换）

可以在替换命令前添加访问（行号），下面命令把50行到100行的old的每次出现都改为new。

```
:50,100 s/old/new/g
```

4）整个文档范围的替换

```
:1,$ s/old/new/g
我们知道%等价于1，$，所以上行命令也可以这样写：
:% s/old/new/g
```

5）确认替换

在替换命令尾部加上c (confirm用于确认)，在替换每个old前都会提示并确认

```
: s/old/new/gc
```

6）上下文相关替换

通过正则确定是否将替换命令应用在该行，即替换操作前，先使用给定的正则判断是否应用在该行。

```
:g /pattern/s/old/new/g
```

语法分析

```
# 第一个g表示是在文件的所有行上进行模式识别，并执行替换命令
# 模式pattern识别要发生替换的行。
# s表示执行替换命令
# old将要被替换的字符
# new替换成的字符
# 最后的g表示在该行上进行全部替换，即该行进行多次匹配
```

特例，下面的三种命令是等价的

```
: g /string/s//new/g
: g/string/s/string/new/g
:% s/string/new/g
```